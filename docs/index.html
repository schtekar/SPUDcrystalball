<!DOCTYPE html>
<html>
<head>
  <title>Kommende offshorebrønner</title>
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet/dist/leaflet.css"
  />
  <style>
    #map { height: 100vh; }
  </style>
</head>
<body>

<h2 style="text-align:center;">Kommende offshorebrønner</h2>
<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
  fetch("data.json")
    .then(response => response.json())
    .then(data => {

      const map = L.map("map").setView([60, 3], 5);

      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        attribution: '&copy; OpenStreetMap contributors'
      }).addTo(map);

      data.forEach(item => {
        if (!item.lat || !item.lon) return;

        const isEntered = item.entryDate && item.entryDate !== "";

        const markerColor = isEntered ? "green" : "red";

        const marker = L.circleMarker([item.lat, item.lon], {
          radius: 7,
          color: markerColor,
          fillColor: markerColor,
          fillOpacity: 0.8
        }).addTo(map);

        const popupHtml = `
          <b>Brønn:</b> ${item.well}<br/>
          <b>Operatør:</b> ${item.operator || "UNKNOWN"}<br/>
          <b>Felt:</b> ${item.field || "UNKNOWN"}<br/>
          <b>Rigg:</b> ${item.rig_name || "UNKNOWN"}<br/>
          <b>Status:</b> ${isEntered ? "Entret" : "Ikke påbegynt"}<br/>
          <b>Entry date:</b> ${item.entryDate || "-"}
        `;

        marker.bindPopup(popupHtml);
      });
    })
    .catch(err => console.error("❌ Feil ved lasting av data.json", err));
</script>

</body>
</html>
